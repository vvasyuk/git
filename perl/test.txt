private Digraph buildEpsilonTransitionDigraph() {
    Digraph G = new Digraph(M + 1);
    Stack<Integer> ops = new Stack<Integer>();
    for (int i = 0; i < M; i ++) {
        int lp = i;
        if (re[i] == '(' || re[i] == '|') 
            ops.push(i);
         else if (re[i] == ')') {
            int or = ops.pop();
            if (re[or] == '|') {
                lp = ops.pop();
                G.addEdge(lp, or + 1);
                G.addEdge(or, i);
            } else 
                lp = or;
        }
        if (i < M - 1 && re[i + 1] == '*') {
            G.addEdge(lp, i + 1);
            G.addEdge(i + 1, lp);
        }
        if (re[i] == '(' || re[i] == '*' || re[i] == ')') 
            G.addEdge(i, i + 1);
    }
    return G;
}
